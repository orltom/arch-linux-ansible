---
- name: check if config directory exists
  stat:
    path: "{{ home_directory }}/configs"
  register: dot_files_directory
  tags:
    - system

- name: clone dot-files
  git:
    repo: "https://github.com/orltom/linux-user-configs"
    dest: "{{ home_directory }}/configs"
    refspec: "+refs/pull/*:refs/heads/*"
    version: master
  when: not dot_files_directory.stat.exists
  tags:
    - system

- name: Remove links
  file:
    path: "{{ home_directory }}/{{ item }}"
    state: absent
  loop:
    - .vimrc
    - .bashrc
    - .zshrc
  tags:
    - system

- name: add config links
  file:
    src: "{{ home_directory }}/configs/{{ item }}"
    dest: "{{ home_directory }}/{{ item }}"
    owner: "{{ username }}"
    group: "{{ unix_group }}"
    state: link
  loop:
    - .vimrc
    - .bashrc
    - .zshrc
    - .aliases
    - .Xresources
    - .zshenv
    - .xintrc
    - .bashrc
  tags:
    - system

- name: link folder
  file:
    src: "{{ home_directory }}/configs/{{ item }}"
    dest: "{{ home_directory }}/{{ item }}"
    owner: "{{ username }}"
    group: "{{ unix_group }}"
    state: link
  loop:
    - bin
    - fonts
    - .vim
    - .mutt
  tags:
    - system

- name: Create .config directory if it does not exist
  file:
    path: "{{ home_directory }}/.config"
    state: directory
    mode: 0750
  tags:
    - system

- name: add .config programm links
  file:
    src: "{{ home_directory }}/configs/.config/{{ item }}"
    dest: "{{ home_directory }}/.config/{{ item }}"
    owner: "{{ username }}"
    group: "{{ unix_group }}"
    state: link
  loop:
    - i3
    - i3status
    - rofi
    - dunst
    - rofi
    - Thunar
    - qalculate
    - remmina
    - ranger
    - fontconfig
  tags:
    - system

- name: set gnome terimal without menu bar
  command: gsettings set org.gnome.Terminal.Legacy.Settings default-show-menubar false
  when: not dot_files_directory.stat.exists
